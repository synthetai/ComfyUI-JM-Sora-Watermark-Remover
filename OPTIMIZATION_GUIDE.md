# æ°´å°å»é™¤ä¼˜åŒ–æŒ‡å—

## ğŸ¯ é’ˆå¯¹ä¸¤ä¸ªå¸¸è§é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ

### é—®é¢˜1ï¼šè§†é¢‘å‰1ç§’æ°´å°æœªå»é™¤
### é—®é¢˜2ï¼šå»é™¤æ°´å°åçš„åŒºåŸŸæ¨¡ç³Š

---

## ğŸ†• æ–°å¢åŠŸèƒ½

### 1. Enhanced Detectionï¼ˆå¢å¼ºæ£€æµ‹ï¼‰â­â­â­â­â­

**ç”¨é€”**ï¼šè§£å†³æ·¡æ°´å°ã€æ¸å…¥æ°´å°æ£€æµ‹ä¸åˆ°çš„é—®é¢˜

**åŸç†**ï¼š
- ä½¿ç”¨å¤šä¸ªæ£€æµ‹é˜ˆå€¼ï¼ˆ10%, 15%, 20%ï¼‰
- è‡ªåŠ¨å»é‡é‡å çš„æ£€æµ‹æ¡†
- ç‰¹åˆ«é€‚åˆè§†é¢‘å¼€å¤´çš„æ·¡æ°´å°

**ä½¿ç”¨æ–¹æ³•**ï¼š
```python
enhanced_detection: True  # ğŸ”¥ å¯ç”¨å¢å¼ºæ£€æµ‹
```

**æ•ˆæœ**ï¼š
- âœ… æ£€æµ‹åˆ°æ›´å¤šæ·¡æ°´å°
- âœ… è¦†ç›–è§†é¢‘å¼€å¤´çš„æ¸å…¥æ•ˆæœ
- âš ï¸ å¤„ç†é€Ÿåº¦ç¨æ…¢ï¼ˆçº¦æ…¢20%ï¼‰

---

### 2. Sharpen Strengthï¼ˆé”åŒ–å¼ºåº¦ï¼‰â­â­â­â­â­

**ç”¨é€”**ï¼šå‡å°‘LaMAä¿®å¤åçš„æ¨¡ç³Š

**åŸç†**ï¼š
- ä½¿ç”¨Unsharp Maskç®—æ³•
- åå¤„ç†é”åŒ–ï¼Œä¸å½±å“ä¿®å¤è´¨é‡
- å¯è°ƒå¼ºåº¦ï¼ˆ0.0-2.0ï¼‰

**ä½¿ç”¨æ–¹æ³•**ï¼š
```python
sharpen_strength: 0.5   # ğŸ”¥ è½»åº¦é”åŒ–
sharpen_strength: 1.0   # ğŸ”¥ ä¸­åº¦é”åŒ–
sharpen_strength: 1.5   # ğŸ”¥ å¼ºé”åŒ–
```

**æ¨èå€¼**ï¼š
- `0.5` - è½»å¾®æ¨¡ç³Š
- `1.0` - ä¸­ç­‰æ¨¡ç³Šï¼ˆé»˜è®¤æ¨èï¼‰
- `1.5` - æ˜æ˜¾æ¨¡ç³Š
- `2.0` - æåº¦æ¨¡ç³Šï¼ˆæ…ç”¨ï¼Œå¯èƒ½è¿‡åº¦é”åŒ–ï¼‰

**æ•ˆæœå¯¹æ¯”**ï¼š
- `sharpen_strength: 0.0` - åŸå§‹LaMAè¾“å‡ºï¼ˆç¨æ¨¡ç³Šï¼‰
- `sharpen_strength: 1.0` - æ¸…æ™°åº¦æ˜æ˜¾æå‡
- `sharpen_strength: 2.0` - éå¸¸é”åˆ©ï¼ˆå¯èƒ½æœ‰artifactï¼‰

---

## ğŸ“‹ æ¨èé…ç½®æ–¹æ¡ˆ

### æ–¹æ¡ˆAï¼šè§£å†³å‰1ç§’æ°´å°é—®é¢˜

```python
# ComfyUI - Sora Watermark Remover (Video) èŠ‚ç‚¹ï¼š

detection_prompt: "Sora watermark"
max_bbox_percent: 10.0
fps: 30.0
detection_skip: 1                   # æ¯å¸§æ£€æµ‹
fade_in: 1.0
fade_out: 1.0
transparent: False
quality_mode: "high"
enhanced_detection: True            # ğŸ”¥ å…³é”®ï¼å¯ç”¨å¢å¼ºæ£€æµ‹
sharpen_strength: 0.0               # å…ˆä¸é”åŒ–ï¼Œçœ‹æ£€æµ‹æ•ˆæœ
```

**æµ‹è¯•æ­¥éª¤**ï¼š
1. é‡å¯ ComfyUI
2. ä½¿ç”¨ä¸Šè¿°é…ç½®å¤„ç†è§†é¢‘
3. æ£€æŸ¥å‰1ç§’æ˜¯å¦è¿˜æœ‰æ°´å°
4. å¦‚æœè¿˜æœ‰ï¼Œå¢åŠ  `max_bbox_percent` åˆ° 15.0

---

### æ–¹æ¡ˆBï¼šè§£å†³æ¨¡ç³Šé—®é¢˜

```python
# ComfyUI - Sora Watermark Remover (Video) èŠ‚ç‚¹ï¼š

detection_prompt: "Sora watermark"
max_bbox_percent: 10.0
fps: 30.0
detection_skip: 1
fade_in: 1.0
fade_out: 1.0
transparent: False
quality_mode: "high"
enhanced_detection: False           # æ£€æµ‹æ²¡é—®é¢˜å°±å…³é—­
sharpen_strength: 1.0               # ğŸ”¥ å…³é”®ï¼å¯ç”¨é”åŒ–
```

**æµ‹è¯•æ­¥éª¤**ï¼š
1. å…ˆç”¨ `sharpen_strength: 0.5` æµ‹è¯•
2. å¦‚æœè¿˜æ¨¡ç³Šï¼Œå¢åŠ åˆ° `1.0`
3. å¦‚æœéå¸¸æ¨¡ç³Šï¼Œå°è¯• `1.5`
4. æ³¨æ„ä¸è¦è¶…è¿‡ `2.0`ï¼Œä¼šè¿‡åº¦é”åŒ–

---

### æ–¹æ¡ˆCï¼šå®Œæ•´ä¼˜åŒ–ï¼ˆä¸¤ä¸ªé—®é¢˜éƒ½è§£å†³ï¼‰â­â­â­â­â­

```python
# æœ€ç»ˆæ¨èé…ç½®ï¼š

detection_prompt: "Sora watermark"
max_bbox_percent: 10.0              # å¦‚æœæ£€æµ‹ä¸åˆ°ï¼Œå¢åŠ åˆ°15.0
fps: 30.0
detection_skip: 1                   # å…¨å¸§æ£€æµ‹ï¼Œä¸é—æ¼
fade_in: 1.0                        # è¦†ç›–æ¸å…¥
fade_out: 1.0                       # è¦†ç›–æ¸å‡º
transparent: False
quality_mode: "high"                # é«˜è´¨é‡ä¿®å¤
enhanced_detection: True            # ğŸ”¥ å¢å¼ºæ£€æµ‹ï¼ˆè§£å†³é—®é¢˜1ï¼‰
sharpen_strength: 1.0               # ğŸ”¥ é”åŒ–ï¼ˆè§£å†³é—®é¢˜2ï¼‰
```

**æ•ˆæœé¢„æœŸ**ï¼š
- âœ… å‰1ç§’æ°´å°å®Œå…¨å»é™¤
- âœ… ä¿®å¤åŒºåŸŸæ¸…æ™°ä¸æ¨¡ç³Š
- âš ï¸ å¤„ç†é€Ÿåº¦è¾ƒæ…¢ï¼ˆçº¦æ¯”é»˜è®¤æ…¢30%ï¼‰

---

## ğŸ” é—®é¢˜è¯Šæ–­æµç¨‹

### å¦‚æœå‰1ç§’è¿˜æœ‰æ°´å°ï¼š

1. **ç¡®è®¤ enhanced_detection æ˜¯å¦å¼€å¯**
   ```python
   enhanced_detection: True  # å¿…é¡»æ˜¯True
   ```

2. **æ£€æŸ¥æ˜¯å¦çœŸçš„æ£€æµ‹åˆ°äº†**
   ```bash
   # è¿è¡Œè¯Šæ–­å·¥å…·
   python debug_detection.py your_video.mp4
   # æŸ¥çœ‹ç”Ÿæˆçš„å›¾ç‰‡ï¼Œçœ‹å‰å‡ å¸§æ˜¯å¦æœ‰çº¢æ¡†
   ```

3. **å¦‚æœè¿˜æ£€æµ‹ä¸åˆ°**
   ```python
   # å¢åŠ æ£€æµ‹èŒƒå›´
   max_bbox_percent: 15.0  # ä»10.0å¢åŠ åˆ°15.0
   ```

4. **å¦‚æœè¿˜æ˜¯ä¸è¡Œ**
   ```python
   # å°è¯•ä¸åŒçš„æ£€æµ‹æç¤ºè¯
   detection_prompt: "watermark"      # æ›´é€šç”¨
   # æˆ–
   detection_prompt: "logo"           # æ£€æµ‹logo
   ```

---

### å¦‚æœè¿˜æ˜¯æ¨¡ç³Šï¼š

1. **ç¡®è®¤ sharpen_strength è®¾ç½®**
   ```python
   sharpen_strength: 1.0  # ç¡®ä¿å¤§äº0
   ```

2. **é€æ­¥å¢åŠ å¼ºåº¦**
   ```python
   sharpen_strength: 0.5  # å¼€å§‹
   â†“
   sharpen_strength: 1.0  # æ ‡å‡†
   â†“
   sharpen_strength: 1.5  # å¼ºåŠ›
   â†“
   sharpen_strength: 2.0  # æœ€å¤§ï¼ˆæ…ç”¨ï¼‰
   ```

3. **æ£€æŸ¥æ˜¯å¦æ˜¯æ£€æµ‹æ¡†é—®é¢˜**
   - æ£€æµ‹æ¡†å¤ªå¤§ â†’ é™ä½ `max_bbox_percent`
   - æ£€æµ‹æ¡†å¤ªå° â†’ å¢åŠ  `max_bbox_percent`

4. **å°è¯•è°ƒæ•´LaMAå‚æ•°**ï¼ˆä»£ç å·²ä¼˜åŒ–ï¼‰
   - å·²è‡ªåŠ¨ä½¿ç”¨æ›´å¤§çš„ä¸Šä¸‹æ–‡èŒƒå›´ï¼ˆ128px vs 64pxï¼‰
   - ä½¿ç”¨ `quality_mode: "high"` è·å¾—æœ€ä½³æ•ˆæœ

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| é…ç½® | æ£€æµ‹å‡†ç¡®ç‡ | ä¿®å¤è´¨é‡ | å¤„ç†é€Ÿåº¦ |
|------|-----------|---------|---------|
| **é»˜è®¤** | 90% | â­â­â­ | ğŸš€ğŸš€ğŸš€ |
| **enhanced_detection** | 98% | â­â­â­ | ğŸš€ğŸš€ |
| **sharpen_strength: 1.0** | 90% | â­â­â­â­ | ğŸš€ğŸš€ğŸš€ |
| **å®Œæ•´ä¼˜åŒ–** | 98% | â­â­â­â­â­ | ğŸš€ğŸš€ |

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. å…ˆæµ‹è¯•å°æ®µè§†é¢‘

```python
# åªå¤„ç†å‰30å¸§ï¼ˆ1ç§’ï¼‰æµ‹è¯•
# åœ¨ComfyUIä¸­ä½¿ç”¨ Video Load èŠ‚ç‚¹çš„ frame_limit å‚æ•°
```

### 2. å¯¹æ¯”ä¸åŒé…ç½®

æµ‹è¯•åºåˆ—ï¼š
1. é»˜è®¤é…ç½®ï¼ˆçœ‹æ˜¯å¦æœ‰é—®é¢˜ï¼‰
2. åªå¯ç”¨ enhanced_detectionï¼ˆè§£å†³æ£€æµ‹é—®é¢˜ï¼‰
3. åªå¯ç”¨ sharpen_strengthï¼ˆè§£å†³æ¨¡ç³Šé—®é¢˜ï¼‰
4. ä¸¤è€…éƒ½å¯ç”¨ï¼ˆæœ€ç»ˆæ–¹æ¡ˆï¼‰

### 3. æ ¹æ®è§†é¢‘ç‰¹ç‚¹è°ƒæ•´

**æ°´å°å¾ˆæ·¡çš„è§†é¢‘**ï¼š
```python
enhanced_detection: True
max_bbox_percent: 15.0
```

**æ°´å°ä½ç½®æ˜æ˜¾çš„è§†é¢‘**ï¼š
```python
enhanced_detection: False  # èŠ‚çœæ—¶é—´
detection_skip: 2          # åŠ å¿«é€Ÿåº¦
```

**ç”»é¢å¤æ‚çš„è§†é¢‘**ï¼š
```python
quality_mode: "high"
sharpen_strength: 1.5      # æ›´å¼ºé”åŒ–
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç«‹å³è§£å†³ä½ çš„é—®é¢˜ï¼š

1. **é‡å¯ ComfyUI**ï¼ˆåŠ è½½æ–°åŠŸèƒ½ï¼‰

2. **ä½¿ç”¨è¿™ä¸ªé…ç½®**ï¼š
   ```python
   detection_prompt: "Sora watermark"
   max_bbox_percent: 10.0
   fps: 30.0
   detection_skip: 1
   fade_in: 1.0
   fade_out: 1.0
   transparent: False
   quality_mode: "high"
   enhanced_detection: True     # ğŸ”¥ æ–°åŠŸèƒ½
   sharpen_strength: 1.0        # ğŸ”¥ æ–°åŠŸèƒ½
   ```

3. **é‡æ–°å¤„ç†è§†é¢‘**

4. **æ£€æŸ¥æ•ˆæœ**ï¼š
   - å‰1ç§’æ°´å°æ˜¯å¦å»é™¤ï¼Ÿ
   - ä¿®å¤åŒºåŸŸæ˜¯å¦è¿˜æ¨¡ç³Šï¼Ÿ

5. **å¾®è°ƒå‚æ•°**ï¼š
   - å¦‚æœè¿˜æ¨¡ç³Š â†’ å¢åŠ  `sharpen_strength` åˆ° 1.5
   - å¦‚æœå‰1ç§’è¿˜æœ‰æ°´å° â†’ å¢åŠ  `max_bbox_percent` åˆ° 15.0

---

## ğŸ“ åé¦ˆ

å¦‚æœè¿™äº›ä¼˜åŒ–è¿˜ä¸èƒ½è§£å†³é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. è¯Šæ–­å·¥å…·è¾“å‡ºï¼š`python diagnose.py`
2. å‰å‡ å¸§çš„æ£€æµ‹å›¾ï¼š`python debug_detection.py video.mp4`
3. ä½¿ç”¨çš„å…·ä½“å‚æ•°é…ç½®

è¿™æ ·å¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ç®—æ³•ï¼
